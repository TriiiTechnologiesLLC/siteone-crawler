# SiteOne Crawler JSON Output Documentation

This document describes the structure and content of the JSON output file generated by the SiteOne Crawler. This JSON file contains detailed information about the crawled website, including metadata about the crawl process, results for each visited URL, and various analysis tables.

## 1. Overview of Information

The JSON output provides a comprehensive dataset about the crawled website. Key information includes:

*   **Crawl Metadata:** Details about the crawler execution, such as version, execution time, command used, hostname, and the final user agent.
*   **Visited URL Results:** For each URL visited during the crawl:
    *   URL address
    *   HTTP status code
    *   Elapsed time for the request (performance)
    *   Size of the response body
    *   Content type (HTML, CSS, JS, Image, etc.)
    *   Caching information (cache flags, lifetime)
    *   Additional analysis results stored in the `extras` field (though empty in the provided example, this often contains specific analyzer outputs).
*   **Analysis Tables:** Aggregated data and specific findings presented in structured tables:
    *   **Skipped URLs:** Reasons why certain URLs were not crawled (e.g., external domain, disallowed by robots.txt, specific rules).
    *   **Redirects:** List of URLs that resulted in redirects (3xx status codes).
    *   **404 Errors:** List of URLs that resulted in a 404 Not Found status.
    *   **SSL/TLS Info:** Details about the website's SSL certificate (issuer, subject, validity dates, supported protocols).
    *   **Performance:** Tables listing the fastest and slowest URLs encountered during the crawl.
    *   **SEO &amp; Content:**
        *   SEO metadata (title, description, keywords, H1, indexing directives) for HTML pages.
        *   OpenGraph metadata (og:title, og:description, og:image, etc.).
        *   Heading structure analysis (correctness of H1-H6 hierarchy).
        *   Analysis of non-unique titles and descriptions across pages.
    *   **Technical Details:**
        *   HTTP Headers: Summary of headers found, their occurrences, and unique values.
        *   Caching Analysis: Breakdown of caching strategies by content type and domain.
        *   DNS Information: DNS resolution details for the target domain.
        *   Security Analysis: Evaluation of security-related HTTP headers.
    *   **Crawler Statistics:** Performance metrics for the crawler itself and individual analyzers.

## 2. Potential Use Cases

The detailed data within the JSON output enables a wide variety of use cases:

1.  **Comprehensive SEO Audits:** Analyze titles, descriptions, heading structures, indexing status, and OpenGraph tags across the entire site.
2.  **Performance Monitoring &amp; Optimization:** Identify the slowest pages and resources, analyze load times, and check caching headers.
3.  **Broken Link Checking:** Easily extract lists of all 404 errors and the pages where they were found.
4.  **Redirect Chain Analysis:** Identify and analyze redirect chains (although the example shows no redirects, the structure supports it).
5.  **Security Header Audits:** Verify the implementation of crucial security headers (CSP, HSTS, X-Frame-Options, etc.) across the site.
6.  **Content Inventory &amp; Analysis:** Get a list of all crawled resources, their types, sizes, and status codes. Analyze content type distribution.
7.  **Website Archiving/Cloning:** While the crawler has a dedicated offline export, the JSON contains the list of all discovered resources, which could inform a custom archiving process.
8.  **Competitive Analysis:** Run the crawler on competitor sites (respecting their `robots.txt`) to gather insights into their structure, performance, and technology.
9.  **CI/CD Integration:** Integrate the crawler into deployment pipelines to automatically check for new errors (404s, performance regressions) after deployments.
10. **Technical Debt Assessment:** Identify outdated practices, missing security headers, or performance issues that need addressing.

## 3. Detailed JSON Structure

The JSON output has the following main top-level keys:

### 3.1. `extraColumnsFromAnalysis` (Array)

An array of objects defining extra columns that might be added during specific analyses. These seem primarily intended for augmenting report outputs. Each object contains:
*   `name` (String): The display name of the column.
*   `length` (Integer): Suggested display length/width.
*   `truncate` (Boolean): Whether the content should be truncated if it exceeds the length.
*   `customMethod`, `customPattern`, `customGroup`: Fields likely used for custom data extraction logic (null in the example).

### 3.2. `crawler` (Object)

Contains metadata about the crawler execution:
*   `name` (String): Name of the crawler software.
*   `version` (String): Version of the crawler.
*   `executedAt` (String): Timestamp when the crawl was executed.
*   `command` (String): The command-line arguments used to run the crawl.
*   `hostname` (String): The hostname where the crawler was run.
*   `finalUserAgent` (String): The User-Agent string used for the HTTP requests.

### 3.3. `results` (Array)

An array of objects, where each object represents a single visited URL.
*   `url` (String): The absolute URL that was visited.
*   `status` (String): The HTTP status code returned (e.g., "200", "404").
*   `elapsedTime` (Float): Time taken to fetch the URL in seconds.
*   `size` (Integer): Size of the response body in bytes.
*   `type` (Integer): An enum representing the detected content type:
    *   `1`: HTML
    *   `2`: JavaScript
    *   `3`: CSS
    *   `4`: Image
    *   `7`: Document (e.g., robots.txt)
    *   `8`: JSON
    *   Other types might exist.
*   `cacheTypeFlags` (Integer): Bitmask representing detected caching mechanisms (e.g., Cache-Control, ETag, Last-Modified). Needs specific interpretation based on the crawler's internal logic. `31` likely means Cache-Control + ETag + Last-Modified. `19` might indicate Cache-Control + Last-Modified. `32768` might indicate no caching headers found.
*   `cacheLifetime` (Integer | null): Cache lifetime in seconds derived from `Cache-Control: max-age` or `Expires` header. `null` if no lifetime could be determined.
*   `extras` (Array | Object): Contains additional data from specific analyzers run on this URL. In the provided example, it's an empty array `[]`, but for HTML pages, it often contains an object with `Title`, `Description`, etc.

### 3.4. `tables` (Object)

An object where each key is a table identifier (e.g., `skipped-summary`, `404`, `seo`) and the value is an object describing that table. Each table object contains:
*   `aplCode` (String): A unique code for the table.
*   `title` (String): A human-readable title for the table.
*   `columns` (Object): An object describing the columns of the table. Each key is a column identifier (e.g., `reason`, `url`, `statusCode`). The value is an object detailing the column:
    *   `aplCode` (String): Unique code for the column.
    *   `name` (String): Display name for the column header.
    *   `width` (Integer): Suggested display width (-1 might mean auto).
    *   `formatter` (Object | null): Defines how the data should be formatted (e.g., adding units like 'ms' or 'kB'). Empty object `{}` might indicate default or specific internal formatting.
    *   `renderer` (Object | null): Defines how the data should be rendered (e.g., adding color or links). Empty object `{}` might indicate default or specific internal rendering.
    *   `truncateIfLonger` (Boolean): Whether to truncate the value if it exceeds the width.
    *   Other fields like `formatterWillChangeValueLength`, `nonBreakingSpaces`, `escapeOutputHtml`, `getDataValueCallback`, `forcedDataType` provide more hints for rendering.
*   `rows` (Array): An array of objects, where each object represents a row in the table. The keys in each row object correspond to the column identifiers defined in `columns`.
*   `position` (String): A hint about where this table should typically be positioned in a report (e.g., `before-url-table`, `after-url-table`).

**Note:** The specific content and structure within `tables` depend heavily on the analyzers enabled during the crawl. The example shows many tables related to performance, SEO, caching, headers, security, and skipped URLs.

## 4. JSON Schema (Draft)

This is a draft JSON schema based on the provided example. It might need refinement based on other possible outputs.

```json
{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SiteOne Crawler JSON Output",
  "description": "Schema for the JSON output file generated by SiteOne Crawler.",
  "type": "object",
  "properties": {
    "extraColumnsFromAnalysis": {
      "description": "Definitions for extra columns used in analyses.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string" },
          "length": { "type": "integer" },
          "truncate": { "type": "boolean" },
          "customMethod": { "type": ["string", "null"] },
          "customPattern": { "type": ["string", "null"] },
          "customGroup": { "type": ["string", "null"] }
        },
        "required": ["name", "length", "truncate"]
      }
    },
    "crawler": {
      "description": "Metadata about the crawler execution.",
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "version": { "type": "string" },
        "executedAt": { "type": "string", "format": "date-time" },
        "command": { "type": "string" },
        "hostname": { "type": "string" },
        "finalUserAgent": { "type": "string" }
      },
      "required": ["name", "version", "executedAt", "command", "hostname", "finalUserAgent"]
    },
    "results": {
      "description": "Array of results for each visited URL.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "url": { "type": "string", "format": "uri" },
          "status": { "type": "string" },
          "elapsedTime": { "type": "number" },
          "size": { "type": "integer" },
          "type": { "type": "integer", "description": "Enum for content type (1:HTML, 2:JS, 3:CSS, 4:Image, ...)" },
          "cacheTypeFlags": { "type": "integer", "description": "Bitmask for caching mechanisms" },
          "cacheLifetime": { "type": ["integer", "null"], "description": "Cache lifetime in seconds or null" },
          "extras": {
            "type": ["array", "object"],
            "description": "Additional analysis data for this URL"
          }
        },
        "required": ["url", "status", "elapsedTime", "size", "type", "cacheTypeFlags", "cacheLifetime", "extras"]
      }
    },
    "tables": {
      "description": "Aggregated analysis results presented as tables.",
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "aplCode": { "type": "string" },
          "title": { "type": "string" },
          "columns": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "aplCode": { "type": "string" },
                "name": { "type": "string" },
                "width": { "type": "integer" },
                "formatter": { "type": ["object", "null"] },
                "renderer": { "type": ["object", "null"] },
                "truncateIfLonger": { "type": "boolean" }
              },
              "required": ["aplCode", "name", "width"]
            }
          },
          "rows": {
            "type": "array",
            "items": {
              "type": "object"
            }
          },
          "position": { "type": "string", "enum": ["before-url-table", "after-url-table"] }
        },
        "required": ["aplCode", "title", "columns", "rows", "position"]
      }
    }
  },
  "required": ["crawler", "results", "tables"]
}